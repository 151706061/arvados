#!/usr/bin/env python

import argparse
import hashlib
import os
import re
import string
import sys
import logging

logger = logging.getLogger(os.path.basename(sys.argv[0]))

parser = argparse.ArgumentParser(
    description='List contents of a manifest')

parser.add_argument('locator', type=str,
                    help="""
Collection locator, optionally with a file path or prefix.
""")

args = parser.parse_args()

import arvados

cr = arvados.CollectionReader(arvados.Keep.get(args.locator))

for f in rc.all_files():
    print(f.stream_name() + "/" + f.name())
