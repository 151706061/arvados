<% if !@object.state.in? ['New', 'Ready'] %>

  <div class="pull-right" style="padding-left: 1em">
    Current state: <span class="badge badge-info" data-pipeline-state="<%= @object.state %>">
      <% if @object.state == "RunningOnServer" %>
        Active
      <% else %>
        <%= @object.state %>
      <% end %>
    </span>&nbsp;
  </div>

<% job_uuids = @object.components.map { |k,j| j[:job].andand[:uuid] }.compact %>

<div id="pipeline-instance-components"
     class="pane-anchor arv-log-event-listener arv-refresh-on-log-event"
     href="#pipeline-instance-components-pane"
     data-pane-content-url="<%= url_for(params.merge(tab_pane: "components_running")) %>"
     data-object-uuids="<%= @object.uuid %> <%= job_uuids.join(' ') %>"
     data-load-throttle="5000"
     >
  <div id="pipeline-instance-components-pane" class="active">

  <%= render_pipeline_components("running", :json) %>

</div>
</div>

<% else %>
  <%# state is either New or Ready %>
  <p><i>Here are all of the pipeline's components (jobs that will need to run in order to complete the pipeline). If you know what you're doing (or you're experimenting) you can modify these parameters before starting the pipeline. Usually, you only need to edit the settings presented on the "Inputs" tab above.</i></p>

  <%= render_pipeline_components("editable", :json, editable: true) %>
<% end %>
