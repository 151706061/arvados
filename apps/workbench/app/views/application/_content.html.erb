<% content_for :content_top do %>
  <% if @object and not @object.is_a?(Group) and @object.class.goes_in_projects? and @object.owner_uuid == current_user.uuid %>
    <div class="pull-right" style="width: 40%">
      <div class="alert alert-warning alert-dismissable">
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
        <strong>Hey.</strong> This <%= @object.class_for_display.downcase %> belongs to your account, but it's not in any of your projects. If you want it to be easy to find in the future, you should move it to a project.<br />
        <%= button_to(choose_projects_path(
                   title: 'Move to...',
                   editable: true,
                   action_name: 'Move',
                   action_href: url_for(action: :update),
                   action_method: 'patch',
                   action_data: {selection_param: @object.resource_param_name+'[owner_uuid]', success: 'page-refresh'}.to_json),
                  { class: "btn btn-primary btn-sm", remote: true, method: 'get' }) do %>
          <i class="fa fa-fw fa-folder"></i> Choose a project...
        <% end %>
      </div>
    </div>
  <% end %>
<% end %>

<% content_for :tab_panes do %>

<% comparable = controller.respond_to? :compare %>
<% pane_list ||= %w(recent) %>
<% panes = Hash[pane_list.map { |pane|
     [pane, render(partial: 'show_' + pane.downcase,
                   locals: { comparable: comparable, objects: @objects })]
   }.compact] %>

<ul class="nav nav-tabs">
  <% panes.each_with_index do |(pane, content), i| %>
    <li class="<%= 'active' if i==0 %>"><a href="#<%= pane %>" data-toggle="tab" id="<%= pane %>-tab"> <%= pane.gsub('_', ' ') %></a></li>
  <% end %>
</ul>
<div class="tab-content">
<% panes.each_with_index do |(pane, content), i| %>
  <div id="<%= pane %>" class="tab-pane fade <%= 'in active' if i==0 %>">
    <div id="<%= pane %>-scroll" class="<%= 'smart-scroll' if pane.match(/graph/) %>" style="margin-top:0.5em;">
      <%= content %>
    </div>
  </div>
<% end %>
</div>

<% end %>

<% content_for :js do %>
    $(window).on('load', smart_scroll_fixup);
    $(document).on('shown.bs.tab', 'ul.nav-tabs > li > a', smart_scroll_fixup);
<% end %>
