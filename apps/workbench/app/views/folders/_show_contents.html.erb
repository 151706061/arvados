<% content_for :content_top do %>

<h2>
  <%= render_editable_attribute @object, 'name', nil, { 'data-emptytext' => "New folder" } %>
</h2>

<div class="arv-description-as-subtitle">
  <%= render_editable_attribute @object, 'description', nil, { 'data-emptytext' => "(No description provided)", 'data-toggle' => 'manual' } %>
</div>

<% end %>

<div class="container-fluid">
  <div class="row">
    <div class="col-lg-4">
      <% if @object.editable? %>
        <%= link_to(
              choose_collections_path(
                title: 'Add data to folder:',
                multiple: true,
                action_name: 'Add',
                action_href: actions_path(id: @object.uuid),
                action_method: 'post',
                action_data: {selection_param: 'selection[]', copy_selections_into_folder: @object.uuid, success: 'page-refresh'}.to_json),
              { class: "btn btn-primary btn-sm", remote: true, method: 'get', data: {'event-after-select' => 'page-refresh'} }) do %>
          <i class="fa fa-fw fa-plus"></i> Add data
        <% end %>
        <%= link_to(
              choose_pipeline_templates_path(
                title: 'Choose a pipeline to run:',
                action_name: 'Configure...',
                action_href: pipeline_instances_path,
                action_method: 'post',
                action_data: {'selection_param' => 'pipeline_instance[pipeline_template_uuid]', 'pipeline_instance[owner_uuid]' => @object.uuid, 'success' => 'redirect-to-created-object'}.to_json),
              { class: "btn btn-primary btn-sm", remote: true, method: 'get' }) do %>
          <i class="fa fa-fw fa-gear"></i> Run a pipeline
        <% end %>
      <% end %>
    </div>
    <div class="col-lg-4">
      <form class="form-inline" role="form">
        Show:
        <select class="form-control" data-filter-rows-by="data-kind" data-filter-target="table.arv-index.arv-folder-contents tbody">
          <option value="">Everything</option>
          <option value="arvados#collection">Data</option>
          <option value="arvados#pipeline_instance arvados#job">Compute jobs</option>
          <option value="arvados#pipeline_template">Pipelines</option>
          <!--
          <option value="arvados#specimen">Specimens</option>
          <option value="arvados#human">Humans</option>
          <option value="arvados#trait">Traits</option>
          -->
        </select>
      </form>
    </div>
    <div class="col-lg-4">
      <input type="text" class="form-control search-folder-contents" placeholder="Search folder contents" data-search-target=".arv-index.arv-folder-contents"/>
    </div>
  </div>
</div>

<table class="table table-condensed arv-index arv-folder-contents">
  <colgroup>
    <col width="40%" />
    <col width="60%" />
  </colgroup>
  <tbody data-infinite-scroller="#Contents-scroll" data-infinite-content-href="<%= url_for(format: :json, partial: :contents_rows, offset: next_page_offset) if next_page_offset %>">
    <%= render partial: 'show_contents_rows', locals: {folder: @object, objects_and_names: @objects_and_names} %>
  </tbody>
  <thead>
    <tr>
      <th>
      </th>
      <th>
        description
      </th>
    </tr>
  </thead>
</table>
