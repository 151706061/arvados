<% content_for :css do %>
.file-list-inline-image {
  width: 50%;
  height: auto;
}
<% end %>

<% content_for :tab_line_buttons do %>
<div class="row">
  <div class="col-md-6"></div>
  <div class="col-md-6">
    <div class="pull-right">
      <%= link_to "Share", sharing_popup_collection_url(id: @object.uuid),  {class: 'btn btn-primary', :remote => true, 'data-toggle' =>  "modal", 'data-target' => '#collection-sharing-modal-window'}  %>
      <span style="padding-left: 1em">Collection storage status:</span>
      <%= render partial: 'toggle_persist', locals: { uuid: @object.uuid, current_state: (@is_persistent ? 'persistent' : 'cache') } %>

    </div>
  </div>
</div>
<% end %>

<table class="table table-condensed table-fixedlayout">
  <colgroup>
    <col width="4%" />
    <col width="35%" />
    <col width="40%" />
    <col width="15%" />
    <col width="10%" />
  </colgroup>
  <thead>
    <tr>
      <th></th>
      <th>path</th>
      <th>file</th>
      <th style="text-align:right">size</th>
      <th>d/l</th>
    </tr>
  </thead><tbody>
    <% if @object then @object.files.sort_by{|f|[f[0],f[1]]}.each do |file| %>
      <% file_path = CollectionsHelper::file_path file %>
      <tr>
        <td>
          <%= check_box_tag 'uuids[]', @object.uuid+'/'+file_path, false, {
                :class => 'persistent-selection',
                :friendly_type => "File",
                :friendly_name => "#{@object.uuid}/#{file_path}",
                :href => "#{url_for controller: 'collections', action: 'show', id: @object.uuid }/#{file_path}",
                :title => "Click to add this item to your selection list"
              } %>
        </td>
        <td>
          <%= file[0] %>
        </td>

      <td>
        <%= link_to (if CollectionsHelper::is_image file[1]
                       image_tag "#{url_for @object}/#{file_path}", class: "file-list-inline-image"
                     else
                       file[1]
                     end),
            {controller: 'collections', action: 'show_file', uuid: @object.uuid, file: file_path, size: file[2], disposition: 'inline'},
            {title: file_path} %>
      </td>

        <td style="text-align:right">
          <%= raw(human_readable_bytes_html(file[2])) %>
        </td>

        <td>
          <div style="display:inline-block">
            <%= link_to raw('<i class="glyphicon glyphicon-download-alt"></i>'), {controller: 'collections', action: 'show_file', uuid: @object.uuid, file: file_path, size: file[2], disposition: 'attachment'}, {class: 'btn btn-info btn-sm', title: 'Download'} %>
          </div>
        </td>
      </tr>
    <% end; end %>
  </tbody>
</table>

<% content_for :footer_html do %>
<div id="collection-sharing-modal-window" class="modal fade" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"></div>
<% end %>
