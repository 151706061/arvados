<% @collections.each do |c| %>

<tr class="collection" data-object-uuid="<%= c.uuid %>">
  <td>
    <% friendly_name = c.friendly_link_name  %>
    <% @collection_info[c.uuid][:tag_links].each do |tag_link| %>
      <% friendly_name += raw(" <span class='label label-info'>#{tag_link.name}</span>") %>
    <% end %>
    <%= render :partial => "selection_checkbox", :locals => {:object => c, :friendly_name => friendly_name} %>
  </td>
  <td>
    <%= link_to_if_arvados_object c.uuid, {:no_tags => true } %>
  </td>
  <td>
    <% i = 0 %>
    <% while i < 3 and i < c.files.length %>
      <% file = c.files[i] %>
      <% file_path = "#{file[0]}/#{file[1]}" %>
      <%= link_to file[1], {controller: 'collections', action: 'show_file', uuid: c.uuid, file: file_path, size: file[2], disposition: 'inline'}, {title: 'View in browser'} %><br />
      <% i += 1 %>
    <% end %>
    <% if i < c.files.length %>
      &vellip;
    <% end %>
  </td>
  <td>
    <%= raw(distance_of_time_in_words(c.created_at, Time.now).sub('about ','~').sub(' ','&nbsp;')) if c.created_at %>
  </td>
  <td>
    <% current_state = @collection_info[c.uuid][:wanted_by_me] ? 'persistent' : 'cache' %>
    <div class="btn-group btn-group-xs toggle-persist fill" data-toggle="buttons" data-remote-href="<%= set_persistent_collection_path(id: c.uuid) %>" data-persistent-state="<%= current_state %>">
      <label class="btn btn-info <%= 'active' if current_state=='persistent' %>">
        <input type="radio" name="wants" value="persistent">Persistent
      </label>
      <label class="btn btn-info <%= 'active' if current_state=='cache' %>">
        <input type="radio" name="wants" value="cache">Cache
      </label>
    </div>
  </td>
  <td class="add-tag-button">
    <a class="btn btn-xs btn-info add-tag-button pull-right" data-remote-href="<%= url_for(controller: 'links', action: 'create') %>" data-remote-method="post"><i class="glyphicon glyphicon-plus"></i>&nbsp;Add</a>
    <span class="removable-tag-container">
    <% if @collection_info[c.uuid] %>
      <% @collection_info[c.uuid][:tag_links].each do |tag_link| %>
        <span class="label label-info removable-tag" data-tag-link-uuid="<%= tag_link.uuid %>"><%= tag_link.name %>
          <% if tag_link.owner_uuid == current_user.uuid %>
          &nbsp;<a title="Delete tag"><i class="glyphicon glyphicon-trash"></i></a>
          <% end %>
        </span>&nbsp;
      <% end %>
    <% end %>
    </span>
  </td>
</tr>

<% end %>
